{
	"name": "Extracao Dados Salesforce CSV",
	"properties": {
		"activities": [
			{
				"name": "Atendimento Paciente",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT  \nAP.CD_ESTABELECIMENTO\n,AP.NR_ATENDIMENTO\n,AP.CD_PESSOA_FISICA\n,TO_CHAR(AP.DT_ENTRADA,'YYYY-MM-DD') AS DT_ENTRADA\n,AP.DS_OBSERVACAO\nFROM ATENDIMENTO_PACIENTE AP\nWHERE TO_CHAR(AP.DT_ENTRADA,'YYYY-MM-DD') BETWEEN '2021-09-01' AND TO_CHAR(SYSDATE,'YYYY-MM-DD')",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "FileServerWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "CloudTasyPrdDataSet",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "CSV_Salesforce_Dinamico",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Laudo",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Atendimento Paciente",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT \t\nLP.NR_ATENDIMENTO\n,LP.CD_PESSOA_FISICA\n,TO_CHAR(LP.DT_LAUDO,'YYYY-MM-DD') DT_LAUDO\n,LP.DS_TITULO_LAUDO\n,LP.NR_PRESCRICAO\n,PP.IE_STATUS_EXECUCAO\n,LP.NR_LAUDO\n,LP.NR_SEQUENCIA\n,C.CD_PESSOA_FISICA AS CD_MEDICO\n,med_resp.cd_pessoa_fisica AS CD_MEDICO_RESP\n,LP.DS_LAUDO\n,PP.NR_SEQ_PROC_INTERNO\n--,PP.CD_PROCEDIMENTO\n--,PROC_INTERNO\tDS_PROC_EXAME\n,TO_CHAR(PP.DT_BAIXA,'YYYY-MM-DD') AS DT_BAIXA\nFROM LAUDO_PACIENTE LP\nLEFT JOIN PRESCR_MEDICA C ON LP.NR_PRESCRICAO = C.NR_PRESCRICAO \nLEFT JOIN PRESCR_PROCEDIMENTO PP ON PP.NR_PRESCRICAO = LP.NR_PRESCRICAO\nLEFT JOIN MEDICO MED_RESP ON med_resp.cd_pessoa_fisica = LP.CD_MEDICO_RESP\nLEFT JOIN MEDICO MED ON MED.CD_PESSOA_FISICA = C.CD_MEDICO\nWHERE TO_CHAR(LP.DT_LAUDO,'YYYY-MM-DD') BETWEEN '2021-09-01' AND TO_CHAR(SYSDATE,'YYYY-MM-DD')",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "FileServerWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "CloudTasyPrdDataSet",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "CSV_Salesforce_Laudo",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Pedido Exame Externo",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Laudo",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT \nA.NR_SEQUENCIA\n,B.NR_ATENDIMENTO\n,B.CD_PROFISSIONAL\n--,B.CD_DOENCA\n,A.NR_PROC_INTERNO\n,A.QT_EXAME\n--,A.NR_SEQ_APRESENT\n,A.IE_LADO\n,A.DS_JUSTIFICATIVA\n,TO_CHAR(B.DT_SOLICITACAO,'YYYY-MM-DD') DT_SOLICITACAO\nFROM pedido_exame_externo_item A\nINNER JOIN PEDIDO_EXAME_EXTERNO B ON A.NR_SEQ_PEDIDO = B.NR_SEQUENCIA \n--WHERE A.NR_SEQ_PEDIDO = 169\nWHERE TO_CHAR(B.DT_SOLICITACAO,'YYYY-MM-DD') BETWEEN '2021-09-01' AND TO_CHAR(SYSDATE,'YYYY-MM-DD')",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "FileServerWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "CloudTasyPrdDataSet",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "CSV_Salesforce_PedidoExameExterno",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Material",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Pedido Exame Externo",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT \n    MAT.CD_MATERIAL\n    ,MAT.DS_MATERIAL\n    ,MAT.DS_REDUZIDA\n    ,'TRUE' AS IE_SITUACAO\nFROM MATERIAL MAT\nWHERE MAT.IE_SITUACAO = 'A'",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "FileServerWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "CloudTasyPrdDataSet",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "CSV_Salesforce_Material",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Alergia",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Material",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT \n    PA.NR_SEQUENCIA\n   ,PA.CD_PESSOA_FISICA\n   ,PA.NR_ATENDIMENTO\n    ,PA.DS_MEDIC_NAO_CAD\n--    ,PA.IE_INTENSIDADE\n    ,PA.CD_MATERIAL\n    ,PA.IE_CONFIRMACAO\n    ,CASE\n        WHEN PA.IE_NEGA_ALERGIAS = 'N' THEN 'FALSE'\n        WHEN PA.IE_NEGA_ALERGIAS = 'S' THEN 'TRUE'\n     END IE_NEGA_ALERGIAS       \n    ,TO_CHAR(PA.DT_REGISTRO,'YYYY-MM-DD') DT_REGISTRO\nFROM paciente_alergia PA\n--WHERE PA.DS_MEDIC_NAO_CAD IS NOT NULL",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "FileServerWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "CloudTasyPrdDataSet",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "CSV_Salesforce_Alergia",
						"type": "DatasetReference"
					}
				]
			}
		],
		"variables": {
			"Filename": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Salesforce"
		},
		"annotations": []
	}
}