{
	"name": "Teste Repasse",
	"properties": {
		"activities": [
			{
				"name": "Repasse Liberado",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT \nPP.NR_ATENDIMENTO    AS NR_ATENDIMENTO\n,PP.NR_INTERNO_CONTA  AS NR_INTERNO_CONTA\n,PP.CD_PROCEDIMENTO  AS CD_ITEM\n,PR.IE_STATUS AS IE_STATUS_REPASSE\n,MAX(PR.DT_LIBERACAO) AS DT_LIBERACAO\n,MAX(PR.DT_ATUALIZACAO) AS DT_ATUALIZACAO\n,SUM(PR.VL_LIBERADO) VL_LIBERADO\nFROM PROCEDIMENTO_REPASSE PR \nINNER JOIN PROCEDIMENTO_PACIENTE PP  ON PP.NR_SEQUENCIA = PR.NR_SEQ_PROCEDIMENTO\nWHERE \n-- PR.NR_REPASSE_TERCEIRO IS NOT NULL\n    PR.IE_STATUS <> 'E'\nGROUP BY\nPP.NR_ATENDIMENTO\n,PP.NR_INTERNO_CONTA \n,PP.CD_PROCEDIMENTO  \n,PR.IE_STATUS\n\nUNION ALL\n\nSELECT \nMAP.NR_ATENDIMENTO    AS NR_ATENDIMENTO\n,MAP.NR_INTERNO_CONTA  AS NR_INTERNO_CONTA\n,MAP.CD_MATERIAL  AS CD_ITEM\n,MR.IE_STATUS AS IE_STATUS_REPASSE\n,MAX(MR.DT_LIBERACAO) AS DT_LIBERACAO\n,MAX(MR.DT_ATUALIZACAO) AS DT_ATUALIZACAO\n,SUM(MR.VL_LIBERADO) VL_LIBERADO\nFROM MATERIAL_REPASSE MR \nINNER JOIN MATERIAL_ATEND_PACIENTE MAP  ON MAP.NR_SEQUENCIA = MR.NR_SEQ_MATERIAL\nWHERE \n-- PR.NR_REPASSE_TERCEIRO IS NOT NULL\n    MR.IE_STATUS <> 'E'\nGROUP BY \nMAP.NR_ATENDIMENTO\n,MAP.NR_INTERNO_CONTA \n,MAP.CD_MATERIAL  \n,MR.IE_STATUS",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE table stg.test_repasse_liberado",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "Tasy_Ciclo",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "REP_LIB",
						"type": "DatasetReference"
					}
				]
			},
			{
				"name": "Conta Paciente Resumo",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Repasse Liberado",
						"dependencyConditions": [
							"Skipped"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "OracleSource",
						"oracleReaderQuery": "SELECT\n    CPR.NR_INTERNO_CONTA\n    ,SUM(CPR.VL_MATERIAL) + SUM(CPR.VL_PROCEDIMENTO)\nFROM CONTA_PACIENTE_RESUMO CPR\nGROUP BY CPR.NR_INTERNO_CONTA",
						"partitionOption": "None",
						"queryTimeout": "02:00:00"
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "--TRUNCATE table stg.test_conta_pac_res",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "Tasy_Ciclo",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "sql_conta_pac",
						"type": "DatasetReference"
					}
				]
			}
		],
		"folder": {
			"name": "Teste"
		},
		"annotations": []
	}
}